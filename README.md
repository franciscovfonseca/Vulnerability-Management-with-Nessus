<br>

<p align="center">
<img width="600" src="https://github.com/user-attachments/assets/47a83722-55a6-41a3-af16-c86a6887ede0" alt="Microsoft Active Directory Logo"/>
<br>
<br>
<br>



# Vulnerability Management with Nessus
<br>

## Introduction
<br>

In this project, I installed and configured **Nessus Essentials** to perform **Vulnerability Scans** against Windows 10 Hosts.

During this process, I followed the **6 Main Stages Of The Vulnerability Management Process** throughout each stage of the scans:

**1️⃣ Discover
2️⃣ Prioritize
3️⃣ Assess
4️⃣ Report
5️⃣ Remediate
6️⃣ Verify**

In doing so, I was able to secure the sandbox networks I set up from a plethora of critical vulnerabilities that were open to attackers worldwide.

<br>

<br>


## Preparation

So, the first thing to do before downloading Nessus Essentials was to create a virtual machine in Azure. This can also be done in AWS, Vmware, etc.

<img width="1489" alt="Screenshot 2023-12-08 at 2 40 27 AM" src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/e61aa6a0-7f48-410e-8110-afccd4665e59">

During the creation of the virtual machine, I made sure it ran Windows 10. After creation each one I then made sure to create a new rule in the Networking section to allow any inbound/outbound connections for this project.

![create new rule ot open vm2023-11-30 at 2 19 36 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/3951d1a5-18db-4fd1-892b-c4511b71d5ed)


In addition, I disabled the firewall in the VM for the Windows 10 machine & verified connections from my host machine to make sure we get efficient results.

![disabling firewall in vm](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/9630b749-83de-4a5b-891a-7a5c6e85e8e0)

![vm machine open](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/bb46da41-4e81-4fab-85d9-d16a104060c5)

After this, I downloaded Nessus Essentials and made sure it was installed on my host computer (not our other vm network).


# Rating After 1st Scan (Initial Settings)

After running a basic Network scan on the windows 10 vm (no credentials) I got these results on vulnerabilities.

![Screenshot 2023-11-30 at 2 37 48 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/20d78147-9ad2-4baa-a86c-0cac3428c790)

![scan compilation 1](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/d0643a5a-05ce-4e40-92bf-c9673ecf534a)



Varying from low to critical, comprising of SSL vulnerabilities to SMB signing that would allow a remote attacker to exploit a man in the middle attack on server.

![Screenshot 2023-11-30 at 2 38 40 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/76cfa103-c174-48f4-9bb0-400b8485c368)

![Screenshot 2023-11-30 at 2 39 06 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/e810e508-eecc-4bd5-a598-a0f2e1aa0dda)



# Preparing For 2nd Scan 

Following the Nessus steps (on their site), on setting up credentialed scans against windows hosts that weren’t on the domain, I first enabled the remote registry, which allows the scanner to connect to the computer’s registry.

![Screenshot 2023-11-30 at 2 48 58 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/0ee5c7b4-c199-4ff5-ba99-10f0af3c9f7b)

Next I made sure the file and printer sharing was turned on as well.

![Screenshot 2023-11-30 at 2 49 29 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/20a6adfa-c7c3-4496-991c-1cf7bbf648f5)

And disabling the notifications in User Account Control Settings since computer is not on the domain to get around for scanning.

![Screenshot 2023-11-30 at 2 49 56 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/89f540d1-4925-4984-91f2-a7fecc17f91a)

Then lastly, adding a key to Registry Editor to further disable account control for the remote account for scans (making things easier for project) before restarting machine.

![Screenshot 2023-11-30 at 2 52 28 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/bd8fd170-654f-4859-83ef-6b50dacd99c6)

![Screenshot 2023-11-30 at 2 53 27 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/946d6a77-e206-4c17-b49f-8d7e1bd836eb)



# Setting Up 2nd Scan (Credentialed) 

With the settings in order we’re ready to setup our second scan. This time using our credentials for the VM and then running the scan again.

![Screenshot 2023-11-30 at 2 56 31 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/e10a5ec6-ca8f-440d-ae4b-42eef3ce78d4)


# Ratings After 2nd Scan (Credentialed)

After running our second scan, we can definitely see an uptick in higher vulnerabilities being present in our Windows 10 network now.


![Screenshot 2023-12-08 at 3 07 31 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/a9dff0f7-d0e7-4260-b1a2-158aa16fc854)

![scan compilation 2](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/6c9beaf9-cf0a-4f99-883d-70ecfb906f65)





This shows the importance of running credentialed scans and the ability to discover even more vulnerabilities that I otherwise wouldn’t have been able to find in scans.

![Screenshot 2023-12-08 at 3 11 23 AM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/235f8f18-218b-489d-afbf-818484daf985)



# Preparing For 3rd Scan (Credentialed + Deprecated Firfox Download)

For our 3rd scan, I downloaded an old version of Firefox (can find online) to our VM.

![Screenshot 2023-11-30 at 12 53 03 PM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/dd7dd2f3-b494-4661-9db0-e451154ddaa8)


Afterwards, I repeated the credentialed scan on our VM to see the new results with the deprecated version of Firefox added.  


# Ratings After 3rd Scan (Credentialed + Deprecated Firfox Download)

As you can see below, the scans correctly showed the many new vulnerabilities that our VM is now open too thanks to the Firefox installation. 

![Screenshot 2023-11-30 at 3 54 54 PM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/f1fae115-2834-47ff-beef-00f099d788e5)

![scan compilation 2](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/dfadf0a4-1e5d-445d-92e9-937a92c51def)


With the version of Firefox being so old, there were a ton of critical vulnerabilities that were picked up from the scan ranging from a plethora of different vectors.


![Screenshot 2023-11-30 at 3 56 00 PM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/5a250fee-e240-4607-9ec7-2d0f042b2846)



# Remediation

Now, there’s several ways of remediation of tasks, going through each of the vulnerabilities one by one, to uninstallation of certain software. For this initial project I go back into the VM and uninstall the “ancient” Firefox, as well as run Windows Updates until there’s no more updates available.


![Screenshot 2023-11-30 at 4 13 21 PM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/5ae2bad2-5ef7-4d1a-b0f0-18ced37da049)


# Ratings After 4th Scan (Remediated Results)

After this, I run the same scan (credentialed) once more and get the results below. Showing a stark contrast in the number of vulnerabilities vs our previous scan(s). 

![Screenshot 2023-11-30 at 9 38 36 PM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/cc0d5995-1262-4b70-ab25-e74a0a93b470)

![last scan compilation](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/0f747237-3967-41c5-9c41-c909fef183c8)



If you're running this lab as well, you can have fun and solve the rest or majority of vulnerabilities from here!



# Conclusion

In this project, several scans were created using Nessus to test unique environments that showed the vulnerabilities within each. Utilizing the tools available within our Azure vms, we were able to remediate many of the vulnerabilities present in our Windows 10 environment and get hands on practice with using the Nessus software in a live environment. 

<br>
<br>
<br>
<br>
<br>
