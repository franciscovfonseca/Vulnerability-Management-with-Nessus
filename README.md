<br>

<p align="center">
<img width="600" src="https://github.com/user-attachments/assets/47a83722-55a6-41a3-af16-c86a6887ede0" alt="Microsoft Active Directory Logo"/>
<br>
<br>
<br>



# Vulnerability Management with Nessus
<br>

## Introduction
<br>

In this project, I installed and configured **Nessus Essentials** to perform **Vulnerability Scans** against Windows 10 Hosts.

During this process, I followed the **6 Main Stages Of The Vulnerability Management Process** throughout each stage of the scans:

<br>

<p align="center">
<img width="800" src="https://github.com/user-attachments/assets/ad0111c1-49c4-4b71-805a-bd908a47b9f0" alt="Microsoft Active Directory Logo"/>
<br>


In doing so, I was able to secure a **Virtual Machine** from a plethora of **Critical Vulnerabilities** that were exposed to attackers worldwide.

<br>

<br>

## Preparation
<br>

The first thing to do before downloading Nessus Essentials was to **Create a Virtual Machine in Azure**.
<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/e61aa6a0-7f48-410e-8110-afccd4665e59" height="100%" width="100%" alt="9"/><br />
<br>

<br>

During the creation of the Virtual Machine, I set it up to run **Windows 10**.

I associated a **Network Security Group** to the VM and created new **Inbound Security Rules** to allow traffic to and from the VM during this project.
<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/3951d1a5-18db-4fd1-892b-c4511b71d5ed" height="100%" width="100%" alt="9"/><br />
<br>

<br>

Additionally, to make sure we'd get efficient results, I **Disabled the Firewall in the VM for the Windows 10 Machine**:
<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/9630b749-83de-4a5b-891a-7a5c6e85e8e0" height="100%" width="100%" alt="9"/><br />
<br>

<br>

And I also **Ensured Connectivity from my Host Machine**:
<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/bb46da41-4e81-4fab-85d9-d16a104060c5" height="100%" width="100%" alt="9"/><br />
<br>

<br>

After this, I downloaded **Nessus Essentials** and installed it on my **Host Computer** (not our other VM Network).

<br>

<br>

## Rating After 1À¢·µó Scan (Initial Settings)
<br>

After running a basic **Network Scan** on the windows 10 VM (no credentials), I got these **Vulnerability Results**:
<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/20d78147-9ad2-4baa-a86c-0cac3428c790" height="100%" width="100%" alt="9"/><br />
<br>

<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/d0643a5a-05ce-4e40-92bf-c9673ecf534a" height="100%" width="100%" alt="9"/><br />
<br>

<br>
 
The vulnerabilities varied from **Low** to **Critical**, and included **SSL Vulnerabilities** and **SMB Signing**, which would allow a remote attacker to exploit a Man-in-the-Middle Attack on the Server.
<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/76cfa103-c174-48f4-9bb0-400b8485c368" height="100%" width="100%" alt="9"/><br />
<br>

<p align="center">
<img src="https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/e810e508-eecc-4bd5-a598-a0f2e1aa0dda" height="100%" width="100%" alt="9"/><br />
<br>

<br>

<br>

## Preparing for 2‚Åø·µà Scan 
<br>

I then followed the Nessus documentd steps in order toset up Credentialed Scans against Windows Hosts that were not on the domain:

**üõà Tenable Nessus Credentialed Checks on Windows**:
https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm#Configure-a-Local-Account

<br>

1. I first enabled the ***Remote Registry***, which allows the scanner to connect to the computer‚Äôs registry and look for insecure configurations:

![Screenshot 2023-11-30 at 2 48 58‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/0ee5c7b4-c199-4ff5-ba99-10f0af3c9f7b)

<br>

2. Next, I Turned On ***file and printer sharing***:

![Screenshot 2023-11-30 at 2 49 29‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/20a6adfa-c7c3-4496-991c-1cf7bbf648f5)

<br>

3. I also disabled the notifications in ***User Account Control Settings***, since the computer was not on the domain, and I had to do this to be able to scan it:

![Screenshot 2023-11-30 at 2 49 56‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/89f540d1-4925-4984-91f2-a7fecc17f91a)

<br>

4. Lastly I connected to the **Registry Editor** and ***added a key*** to further disable *user account control* for the remote account that I used to connect to the computer during the scan:

![Screenshot 2023-11-30 at 2 52 28‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/bd8fd170-654f-4859-83ef-6b50dacd99c6)

![Screenshot 2023-11-30 at 2 53 27‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/946d6a77-e206-4c17-b49f-8d7e1bd836eb)

<br>

<br>

## Setting Up 2‚Åø·µà Scan (Credentialed) 
<br>

After configuring all the necessary settings, I was ready to perform the **Second Scan**.

This time I used our credentials for the VM and ran the scan again.

![Screenshot 2023-11-30 at 2 56 31‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/e10a5ec6-ca8f-440d-ae4b-42eef3ce78d4)

<br>

<br>

## Ratings After 2‚Åø·µà Scan (Credentialed)
<br>

After running the Second Scan, we can definitely see there was an increase in **Higher-Level Vulnerabilities** in the Windows 10 network.


![Screenshot 2023-12-08 at 3 07 31‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/a9dff0f7-d0e7-4260-b1a2-158aa16fc854)

![scan compilation 2](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/6c9beaf9-cf0a-4f99-883d-70ecfb906f65)





This shows the importance of running **Credentialed Scans** which allows us to discover more vulnerabilities that otherwise we wouldn‚Äôt be able to find with our standard scans.

![Screenshot 2023-12-08 at 3 11 23‚ÄØAM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/235f8f18-218b-489d-afbf-818484daf985)

<br>

<br>

## Preparing for 3 ≥·µà Scan (Credentialed + Deprecated Firfox Download)
<br>

For the 3 ≥·µà Scan, I downloaded an old version of Firefox (which we can find online) to our VM.

![Screenshot 2023-11-30 at 12 53 03‚ÄØPM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/dd7dd2f3-b494-4661-9db0-e451154ddaa8)


Afterwards, I repeated the **Credentialed Scan** on our VM to see the new results with the deprecated version of Firefox added.  

<br>

<br>

## Ratings After 3 ≥·µà Scan (Credentialed + Deprecated Firfox Download)
<br>

As you can see below, the scans showed the various **New Vulnerabilities** that our VM is now exposed to ‚ûî due to the installation of the old version of Firefox. 

![Screenshot 2023-11-30 at 3 54 54‚ÄØPM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/f1fae115-2834-47ff-beef-00f099d788e5)

![scan compilation 2](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/dfadf0a4-1e5d-445d-92e9-937a92c51def)


Since the version of Firefox was so outdated, there were a lot of **Critical Vulnerabilities** that were picked up by the scan, of different types and sources.


![Screenshot 2023-11-30 at 3 56 00‚ÄØPM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/5a250fee-e240-4607-9ec7-2d0f042b2846)

<br>

<br>

## Remediation
<br>

There're several ways to address the remediation process, including going through each of the vulnerabilities one by one, or uninstall certain software.

For this initial project, I went back to the VM and **uninstalled the old version of Firefox**, and I also **ran Windows Updates**, until there were no more updates available.


![Screenshot 2023-11-30 at 4 13 21‚ÄØPM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/5ae2bad2-5ef7-4d1a-b0f0-18ced37da049)

<br>

<br>

## Ratings After 4·µó ∞ Scan (Remediated Results)
<br>

After that, I ran the same **Credentialed Scan** one more time and got the results below.

![Screenshot 2023-11-30 at 9 38 36‚ÄØPM](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/cc0d5995-1262-4b70-ab25-e74a0a93b470)

![last scan compilation](https://github.com/EricMcclellan1/nessus-vulnerability/assets/147299619/0f747237-3967-41c5-9c41-c909fef183c8)

‚úÖ We can clearly see a stark contrast in the number of vulnerabilities between this last scan vs. our previous scans. 

<br>

  <details close> 
  
**<summary>üí°</summary>**

If you're running this lab as well, you can have fun from here solving a few more of the vulnerabilities identified!

  </details>

<br>



<br>

<br>

## Conclusion
<br>

In this project, I performed several scans using **Nessus Vulnerability Scanner** to test our Network Environments, which allowed me to identify several Vulnerabilities.

Utilizing the tools available within our Azure VMs, I was able to remediate many of the Vulnerabilities, and got hands on practice with using the **Nessus Software** in a live environment. 

<br>
<br>
<br>
<br>
<br>
